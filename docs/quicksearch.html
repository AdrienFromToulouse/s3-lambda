<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" S3renity Classes BatchRequestContextS3renity Classes Classes BatchRequest Context S3renity × Search results Close Little Star Media, 2015 Documentation generated by JSDoc 3.4.0 on 2016-01-08T22:23:52-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" S3renity Classes BatchRequestContextS3renity S3renityS3renity allows you to treat S3 directories like arrays, and lets you perform batch operations on them. Some use cases... Quickly prototype MapReduce jobs Clean or organize dirty log files Perform sync or async functions over each file with forEach, map, reduce, and filter Many more... Installnpm install s3renity --saveBatch Functions forEach map reduce filter join Extra Functionality list get put delete splitObject Examplevar S3renity = require('s3renity'); var s3renity = new S3renity({ access_key_id: 'your access key', secret_access_key: 'your secret key' }); // Print out the contents of every file in an S3 directory var bucket = 'my-bucket'; var prefix = 'path/to/files'; var print = body =&gt; console.log(body); s3renity .context(bucket, prefix) // sets the directory context in S3 .forEach(print) // function to perform over each s3 object .then(() =&gt; console.log('done')) // continue .catch(e =&gt; console.log(e)) // handle errorAdvanced ExamplesPerform an asynchronous db lookup for every line of JSON in every file in the working context. const lookupId = line =&gt; { line = JSON.parse(line); return new Promise((success, fail) =&gt; { db.lookup(line.id).then(success).catch(fail); }); }; s3renity .context(path) .split('\\n') .forEach(lookupId, true) .then(_ =&gt; console.log('done!')) .catch(e =&gt; console.log(e))Add a field to each log entry and then concatonate all the files into one and save it locally. var folder = 's3://bucket/path/to/folder'; var tmpFolder = 's3://bucket/path/to/temporary/output/folder'; var localOutput = 'output.txt'; s3renity .context(folder) .split('\\n') .target(tmpFolder) .map(entry =&gt; { var temp = JSON.parse(entry); if (temp.timestamp == null) { temp.timestamp = Date.now()/1000|0; } return temp; }) .then(_ =&gt; { s3renity.ctx(tmpFolder).join('\\n').then(results =&gt; { s3renity.write(results, localOutput); })} ) .catch(err =&gt; console.log(err)); × Search results Close Little Star Media, 2015 Documentation generated by JSDoc 3.4.0 on 2016-01-08T22:23:52-05:00 using the DocStrap template. "},"BatchRequest.html":{"id":"BatchRequest.html","title":"Class: BatchRequest","body":" S3renity Classes BatchRequestContextS3renity Class: BatchRequest BatchRequest Self-contained batch request object, created by S3renity#context. new BatchRequest(s3, bucket, key, marker) Parameters: Name Type Argument Description s3 S3renity The S3renity instance to use for making s3 requests bucket String The bucket key String The key marker String &lt;optional&gt; The key to start from Methods encode(encoding) Sets the encoding to use when getting s3 objects with object.Body.toString(encoding). If not set, utf8 is used. Parameters: Name Type Description encoding String The encoding Inherited From: Context#encode Returns: this Type Context filter(func, isAsync) Filter the objects in the working context. Parameters: Name Type Description func function The function to filter objects by, returning true for objects that should not be filtered and false for those that should. If isAsync is set to true, func returns a promise that resolves to true or false. isAsync boolean Optional, defaults to false. If set to true, this indicates that func returns a promise. forEach(func, isAsync) Run a function over s3 objects in a for-each construct. Parameters: Name Type Argument Default Description func function The function to perform over the working context isAsync Boolean &lt;optional&gt; false Set to true if `func` is async (returns a Promise). Returns: The last key iterated over. Type Promise.&lt;string&gt; join(delimiter) Join the objects in the working context by the given delimiter and return the result. Parameters: Name Type Default Description delimiter String '\\n' The character used to join the s3 objects Returns: The joined body. Type Promise map(func, isAsync) Maps a function over the objects in the working context, replaceing each with the return value. If an output is specified, the objects will not be overwritten, but rather copied to the target location. Parameters: Name Type Argument Default Description func function The function to map over each object in the working context. func takes a string as a parameter and should return a string that will replace the given s3 object. isAsync Boolean &lt;optional&gt; false If set to true, this indicates that func is async and returns a promise. Returns: Type Promise marker(marker) Sets the marker. Parameters: Name Type Description marker String The marker to start with for getting objects Inherited From: Context#marker Overrides: Context#marker Returns: this Type Context output(bucket, prefix) Sets the output directory for map or filter. If a target is set, map and filter write to that location instead of changing the original objects themselves. Parameters: Name Type Description bucket String The target bucket. prefix String The target prefix (folder) where the output will go. Inherited From: Context#output Returns: this Type Context reduce(func, initialValue, isAsync) Reduce the objects in the working context to a single value. Parameters: Name Type Description func function Function to execute on each value in the array, taking three arguments: previousValue - The value previously returned in the last invocation of func currentValue - The current entry being processed key - The key of the current object being processed func either returns the updated value, or a promise that resolves to the updated value. initialValue string Optional. Value to use as the first argument to the first call of func. isAsync boolean Optional, defaults to false. If set to true, this indicates that func returns a promise. Returns: Returns the reduced result. Type promise transform(transformer) Sets a transformation function to be used when getting objects from s3. Using transform takes precedence over encode. Parameters: Name Type Description transformer function The function to use to transform the object. The transforation function takes an s3 object as a parameter and should return the file's contents as a string. Inherited From: Context#transform Returns: this Type Context × Search results Close Little Star Media, 2015 Documentation generated by JSDoc 3.4.0 on 2016-01-08T22:23:52-05:00 using the DocStrap template. "},"Context.html":{"id":"Context.html","title":"Class: Context","body":" S3renity Classes BatchRequestContextS3renity Class: Context Context A Context enables you to chain set conditions for batch functions. Contexts are reusable. new Context(s3, bucket, prefix, marker) Creates a new Context to perform batch operations with. You can either supply an s3 path like s3:///path/to/folder or a bucket and prefix. Parameters: Name Type Argument Description s3 S3renity The s3renity instance used for internal requests bucket String The bucket to use prefix String The prefix (folder) to use marker String &lt;optional&gt; The key to start at when getting objects Methods encode(encoding) Sets the encoding to use when getting s3 objects with object.Body.toString(encoding). If not set, utf8 is used. Parameters: Name Type Description encoding String The encoding Returns: this Type Context marker(marker) Sets the marker. Parameters: Name Type Description marker String The marker to start with for getting objects Returns: this Type Context output(bucket, prefix) Sets the output directory for map or filter. If a target is set, map and filter write to that location instead of changing the original objects themselves. Parameters: Name Type Description bucket String The target bucket. prefix String The target prefix (folder) where the output will go. Returns: this Type Context transform(transformer) Sets a transformation function to be used when getting objects from s3. Using transform takes precedence over encode. Parameters: Name Type Description transformer function The function to use to transform the object. The transforation function takes an s3 object as a parameter and should return the file's contents as a string. Returns: this Type Context × Search results Close Little Star Media, 2015 Documentation generated by JSDoc 3.4.0 on 2016-01-08T22:23:52-05:00 using the DocStrap template. "},"S3renity.html":{"id":"S3renity.html","title":"Class: S3renity","body":" S3renity Classes BatchRequestContextS3renity Class: S3renity S3renity A S3renity instance allows you to create contexts for batch requests. It also gives you a promise-based wrapper around the S3 api. new S3renity(config) Parameters: Name Type Description config Object Options to initialize s3renity with. If access_key_id and secret_access_key are left out, the aws sdk will attempt to use the computer's default credentials. Properties Name Type Argument Default Description access_key_id String &lt;optional&gt; null AWS Access Key secret_access_key String &lt;optional&gt; null AWS Secret Key timeout Integer &lt;optional&gt; 120 Timeout allowed for aws api requests maxRetries Integer &lt;optional&gt; 30 Max retries allowed for aws api requets verbose Boolean &lt;optional&gt; false Whether to use verbose mode when making requets Methods context(bucket, prefix, marker) Creates a new BatchRequest context to perform batch operations with. You can either supply an s3 path like s3://bucket/path/to/folder or a bucket and prefix. Parameters: Name Type Argument Description bucket String The bucket to use, or a valid s3 path prefix String The prefix (folder) to use. Leave null if you gave an s3 path marker String &lt;optional&gt; The key to start from Returns: A new batch request instance. Type BatchRequest copy(bucket, key, targetBucket, targetKey) Copies an object in S3. Parameters: Name Type Description bucket String The source bucket key String The source key targetBucket String The target bucket targetKey String The target key Returns: Type Promise delete(bucket, key) Deletes an object or array of objects in S3. Parameters: Name Type Description bucket String The bucket key String | Array The key to delete or an array of keys to delete Returns: The key (or array of keys) that was deleted. Type Promise get(bucket, key, encoding, transformer) Gets an object in s3. Parameters: Name Type Argument Default Description bucket String The bucket to get from key String The key of the object to get encoding String &lt;optional&gt; utf8 The encoding transformer function &lt;optional&gt; If supplied, this function will be run on Object.Body before returning. Useful for dealing with compressed files or weird formats Returns: The s3 text object. Type Promise list(bucket, prefix, marker) Lists all the keys in the given s3 folder. Parameters: Name Type Argument Description bucket String The bucket prefix String The prefix for the folder to list keys for marker String &lt;optional&gt; The key to start listing from, alphabetically Returns: an array containing all the keys in s3:///. Type Promise put(bucket, key, body, encoding) Puts a text object in S3. Parameters: Name Type Argument Default Description bucket String The s3 bucket to use key String The key path where the object will be placed body String The object body encoding String &lt;optional&gt; utf8 The encoding Returns: Promise that resolves when the object is written to s3 Type Promise × Search results Close Little Star Media, 2015 Documentation generated by JSDoc 3.4.0 on 2016-01-08T22:23:52-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
