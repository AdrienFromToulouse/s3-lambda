<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" S3renity Classes BatchRequestContextS3renity Classes Classes BatchRequest Context S3renity × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-01-23T10:59:32-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" S3renity Classes BatchRequestContextS3renity S3renityS3renity is an S3 toolbelt for Node.js that enables you to treat directories like arrays of S3 objects, and perform batch functions on them. It also provides a promise-based wrapper around the s3 api. Some things we use S3renity for at Littlstar are prototyping MapReduce jobs and cleaning/organizing logs. Quick Exampleconst S3renity = require('s3renity'); const s3renity = new S3renity({ aws_access_key: '', aws_secret_key: '', max_retries: 30, // optional timeout: 120, // optional verbose: true // optional }); const bucket = 'my-bucket'; const prefix = 'path/to/files/'; s3renity .context(bucket, prefix) .forEach(object =&gt; { /* do something with object */ }) .then(console.log('done!')) .catch(console.error);Installnpm install s3renity --saveBatch FunctionsPerform sync or async functions over each file in a directory. forEach map reduce filter join context(bucket, prefix[, marker])Sets the working context for a batch request, so s3renity knows where the files are in s3. If a marker is specified, the working context is every file after that file alphabetically. const bucket = 'my-bucket'; const prefix = 'path/to/files/'; const marker = 'path/to/files/file3'; // only operate on files after `file3` s3renity .context(bucket, prefix, marker) // .forEach() || .map || .reduce() || .filter() || .join() forEach(func[, isAsync])Loops over each file in a s3 directory and performs func. If isAsync is true, func should return a Promise. s3renity .context(bucket, prefix) .forEach(object =&gt; { /* do something with object */ }) .then(console.log('done!') .catch(console.error); map(func[, isAsync])Destructive. Maps func over each file in an s3 directory, replacing each file with what is returned from the mapper function. If isAsync is true, func should return a Promise. const addSmiley = object =&gt; object + ':)'; s3renity .context(bucket, prefix) .map(addSmiley) .then(console.log('done!')) .catch(console.error);You can make this non-destructive by specifying an output directory. s3renity .context(bucket, prefix) .output(outputBucket, outputPrefix) .map(addSmiley) .then(console.log('done!') .catch(console.error) reduce(func[, isAsync])Reduces the objects in the working context to a single value. // concatonates all the files const reducer = (previousValue, currentValue, key) =&gt; { return previousValue + currentValue }; s3renity .context(bucket, prefix) .reduce(reducer) .then(result =&gt; { /* do something with result */) .catch(console.error); filter(func[, isAsync])Destructive. Filters (deletes) files in s3. func should return true to keep the object, and false to delete it. If isAsync is true, func returns a Promise. // filters empty files const filter = object =&gt; object.length &gt; 0; s3renity .context(bucket, prefix) .filter(filter) .then(console.log('done!') .catch(console.error);Just like in map, you can make this non-destructive by specifying an output directory. s3renity .context(bucket, prefix) .output(outputBucket, outputPrefix) .filter(filter) .then(console.log('done!')) .catch(console.error(); join(delimiter)Joins objects in s3 to a single value. s3renity .context(bucket, prefix) .join('\\n') .then(result =&gt; { /* do something with result */ } .catch(console.error);S3 FunctionsPromise-based wrapper around common S3 methods. list get put copy delete list(bucket, prefix[, marker])Returns an array of keys in s3://bucket/prefix. If you use a marker, the s3renity will start listing alphabetically from there. s3renity .list(bucket, prefix) .then(keys =&gt; { /* do something with keys */ } .catch(console.error);get(bucket, key[, encoding[, transformer]])Gets an object in s3, calling toString(encoding on objects. s3renity .get(bucket, key) .then(object =&gt; { /* do something with object */ } .catch(console.error);Optionally you can supply your own transformer function to use when retrieving objects. const zlib = require('zlib'); const transformer = object =&gt; { return zlib.gunzipSync(object).toString('utf8'); } s3renity .get(bucket, key, null, transformer) .then(object =&gt; { /* do something with object */ } .catch(console.error);put(bucket, key, object[, encoding])Puts an object in s3. Default encoding is utf8. s3renity .put(bucket, key, 'hello world!') .then(console.log('done!').catch(console.error);copy(bucket, key, targetBucket, targetKey)Copies an object in s3 from s3://sourceBucket/sourceKey to s3://targetBucket/targetKey. s3renity .copy(sourceBucket, sourceKey, targetBucket, targetKey) .then(console.log('done!').catch(console.error);delete(bucket, key)Deletes an object in s3 (s3://bucket/key). s3renity .delete(bucket, key) .then(console.log('done!').catch(console.error); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-01-23T10:59:32-05:00 using the DocStrap template. "},"BatchRequest.html":{"id":"BatchRequest.html","title":"Class: BatchRequest","body":" S3renity Classes BatchRequestContextS3renity Class: BatchRequest BatchRequest Self-contained batch request object, created by S3renity#context. Once created, you can chain settings commands together before executing a batch request. new BatchRequest(s3, bucket, key, marker) A BatchRequest can only be created by calling S3renity#context. Parameters: Name Type Argument Description s3 S3renity The S3renity instance to use for making s3 requests bucket String The bucket key String The key marker String &lt;optional&gt; The key to start from Methods encode(encoding) Sets the encoding to use when getting s3 objects with object.Body.toString(encoding). If not set, utf8 is used. Parameters: Name Type Description encoding String The encoding Inherited From: Context#encode Returns: this Type Context filter(func, isAsync) Filter the objects in the working context. Parameters: Name Type Description func function The function to filter objects by, returning true for objects that should not be filtered and false for those that should. If isAsync is set to true, func returns a promise that resolves to true or false. isAsync boolean Optional, defaults to false. If set to true, this indicates that func returns a promise. forEach(func, isAsync) Run a function over s3 objects in a for-each construct. Parameters: Name Type Argument Default Description func function The function to perform over the working context isAsync Boolean &lt;optional&gt; false Set to true if `func` is async (returns a Promise). Returns: The last key iterated over. Type Promise.&lt;string&gt; join(delimiter) Join the objects in the working context by the given delimiter and return the result. Parameters: Name Type Default Description delimiter String '\\n' The character used to join the s3 objects Returns: The joined body. Type Promise map(func, isAsync) Maps a function over the objects in the working context, replaceing each with the return value. If an output is specified, the objects will not be overwritten, but rather copied to the target location. Parameters: Name Type Argument Default Description func function The function to map over each object in the working context. func takes a string as a parameter and should return a string that will replace the given s3 object. isAsync Boolean &lt;optional&gt; false If set to true, this indicates that func is async and returns a promise. Returns: Type Promise marker(marker) Sets the marker. Parameters: Name Type Description marker String The marker to start with for getting objects Inherited From: Context#marker Overrides: Context#marker Returns: this Type Context output(bucket, prefix) Sets the output directory for map or filter. If a target is set, map and filter write to that location instead of changing the original objects themselves. Parameters: Name Type Description bucket String The target bucket. prefix String The target prefix (folder) where the output will go. Inherited From: Context#output Returns: this Type Context reduce(func, initialValue, isAsync) Reduce the objects in the working context to a single value. Parameters: Name Type Description func function Function to execute on each value in the array, taking three arguments: previousValue - The value previously returned in the last invocation of func currentValue - The current entry being processed key - The key of the current object being processed func either returns the updated value, or a promise that resolves to the updated value. initialValue string Optional. Value to use as the first argument to the first call of func. isAsync boolean Optional, defaults to false. If set to true, this indicates that func returns a promise. Returns: Returns the reduced result. Type promise transform(transformer) Sets a transformation function to be used when getting objects from s3. Using transform takes precedence over encode. Parameters: Name Type Description transformer function The function to use to transform the object. The transforation function takes an s3 object as a parameter and should return the file's contents as a string. Inherited From: Context#transform Returns: this Type Context × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-01-23T10:59:32-05:00 using the DocStrap template. "},"Context.html":{"id":"Context.html","title":"Class: Context","body":" S3renity Classes BatchRequestContextS3renity Class: Context Context A Context enables you to chain set conditions for batch functions. Contexts are reusable. new Context(s3, bucket, prefix, marker) Creates a new Context to perform batch operations with. You can either supply an s3 path like s3:///path/to/folder or a bucket and prefix. Parameters: Name Type Argument Description s3 S3renity The s3renity instance used for internal requests bucket String The bucket to use prefix String The prefix (folder) to use marker String &lt;optional&gt; The key to start at when getting objects Methods encode(encoding) Sets the encoding to use when getting s3 objects with object.Body.toString(encoding). If not set, utf8 is used. Parameters: Name Type Description encoding String The encoding Returns: this Type Context marker(marker) Sets the marker. Parameters: Name Type Description marker String The marker to start with for getting objects Returns: this Type Context output(bucket, prefix) Sets the output directory for map or filter. If a target is set, map and filter write to that location instead of changing the original objects themselves. Parameters: Name Type Description bucket String The target bucket. prefix String The target prefix (folder) where the output will go. Returns: this Type Context transform(transformer) Sets a transformation function to be used when getting objects from s3. Using transform takes precedence over encode. Parameters: Name Type Description transformer function The function to use to transform the object. The transforation function takes an s3 object as a parameter and should return the file's contents as a string. Returns: this Type Context × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-01-23T10:59:32-05:00 using the DocStrap template. "},"S3renity.html":{"id":"S3renity.html","title":"Class: S3renity","body":" S3renity Classes BatchRequestContextS3renity Class: S3renity S3renity S3renity allows you to run BatchRequest, as well as interact with s3 objects directly through a promise-based api. new S3renity(config) Parameters: Name Type Description config Object Options to initialize s3renity with. If access_key_id and secret_access_key are left out, the aws sdk will attempt to use the computer's default credentials. Properties Name Type Argument Default Description access_key_id String &lt;optional&gt; null AWS Access Key secret_access_key String &lt;optional&gt; null AWS Secret Key max_retries Integer &lt;optional&gt; 30 Max retries allowed for aws api requets timeout Integer &lt;optional&gt; 120 Timeout allowed for aws api requests verbose Boolean &lt;optional&gt; false Whether to use verbose mode when making requets Methods context(bucket, prefix, marker) Creates a new BatchRequest context. Parameters: Name Type Argument Description bucket String The bucket to use, or a valid s3 path prefix String The prefix (folder) to use. Leave null if you gave an s3 path marker String &lt;optional&gt; The key to start from Returns: A new batch request instance. Type BatchRequest copy(bucket, key, targetBucket, targetKey) Copies an object in S3. Parameters: Name Type Description bucket String The source bucket key String The source key targetBucket String The target bucket targetKey String The target key Returns: Type Promise delete(bucket, key) Deletes an object or array of objects in S3. Parameters: Name Type Description bucket String The bucket key String | Array The key to delete or an array of keys to delete Returns: The key (or array of keys) that was deleted. Type Promise get(bucket, key, encoding, transformer) Gets an object in s3. Parameters: Name Type Argument Default Description bucket String The bucket to get from key String The key of the object to get encoding String &lt;optional&gt; utf8 The encoding transformer function &lt;optional&gt; If supplied, this function will be run on Object.Body before returning. Useful for dealing with compressed files or weird formats Returns: The s3 text object. Type Promise list(bucket, prefix, marker) Lists all the keys in the given s3 folder. Parameters: Name Type Argument Description bucket String The bucket prefix String The prefix for the folder to list keys for marker String &lt;optional&gt; The key to start listing from, alphabetically Returns: An array containing all the keys in s3://bucket/prefix. Type Promise put(bucket, key, body, encoding) Puts a text object in S3. Parameters: Name Type Argument Default Description bucket String The s3 bucket to use key String The key path where the object will be placed body String The object body encoding String &lt;optional&gt; utf8 The encoding Returns: Promise that resolves when the object is written to s3 Type Promise × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-01-23T10:59:32-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
